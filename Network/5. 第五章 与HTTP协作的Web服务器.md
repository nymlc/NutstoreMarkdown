一台`Web`服务器可搭建多个独立域名的`Web`网站也可以作为中转服务器提升传输效率
# 用单台虚拟主机实现多个域名

`HTTP/1.1`允许一台`HTTP`服务器搭建多个`Web`站点，比如提供`Web`托管服务的供应商可以用一台服务器为多个客户服务，每个客户持有的域名运行各自的网站。这就是运用了虚拟主机功能，也就是虽然一台主机，但是可以虚拟出来多个主机

我们知道就像`www.baidu.com`，它通过`DNS`服务最终会得到一个`IP`地址，要是一台主机托管了多个域名，它们都指向同一个`IP`地址，这时候就得弄清楚这个请求到底是哪个，所以请求的`Host`首部得完整指定域名或者主机名的`URI`

# 通信数据转发程序 ：代理、网关、隧道

`HTTP`通信时除了客户端和服务端还有一些应用程序用于数据转发，就像代理、网关、隧道

## 代理

也叫网络代理，它是一种网络服务，允许一个网络终端（通常是客户端）通过这个服务和另外一个网络终端（通常是服务端）进行非直接的相连。它有利于保障网络终端的安全

用处么也很多，就像我们访问不了`gooele`，我们就可以通过代理。我们首先和代理建立连接，告诉它我们需要访问`google`，这样子它就会和`google`建立连接然后把响应返回给我们

<img src="https://raw.githubusercontent.com/nymlc/picgo/master/markdownimage-20200528202850051.png" alt="image-20200528202850051" style="zoom:50%;" />

代理有多种使用方法按照俩种基准划分，一则是否使用缓存，二则是否修改报文：

+ 缓存代理：代理转发响应的时候，缓存代理会把资源副本存在代理服务器上，这样子下次请求相同的资源就可以直接返回
+ 透明代理：不修改请求或者响应就是透明，反之不透明

## 网关

网关看起来和代理类似，它是转发其他服务端数据的服务器，它能够转换协议，所以通常被指为一种转换协议的设备，就像语音网关。它对外提供`HTTP`协议进行通信，内部却是非`HTTP`协议

<img src="https://raw.githubusercontent.com/nymlc/picgo/master/markdownimage-20200528203810717.png" alt="image-20200528203810717" style="zoom:50%;" />

它就像海关一样，要是俩个终端在同一个广播域内具有相同网段那么就可以通过`ARP`发现彼此`MAC`地址直接通信，这是不需要网关的

利用网关可以提高通信安全，因为可以在客户端和网关之间的通信线路上加密

## 隧道

隧道可以和其它服务器建立一条通信线路，采用`SSL`等手段加密，它的目的就是确保客户端和服务器端安全通信。它不会去解析请求，我们可以不用在意它的存在。隧道会在通信双方断开连接结束

隧道使得远距离的服务器可以安全通信。不像通常情况下会经过各种代理服务器、网关等设备转发

>代理和网关看起来有点类似，这里说下区别：
>
>+ 代理协议不会转变，但是网关会，所以网关安全
>+ 代理服务器可以做信息过滤，网关不会

# 保存资源的缓存

缓存有客户端本地也有缓存服务器，利用它可以减少对源服务器的访问，也就减少通信时间、流量

<img src="https://raw.githubusercontent.com/nymlc/picgo/master/markdownimage-20200528210440118.png" alt="image-20200528210440118" style="zoom:50%;" />

## 缓存的有效期限

很明显缓存有有效期限，毕竟源服务器资源改了不代表缓存服务器改了

<img src="https://raw.githubusercontent.com/nymlc/picgo/master/markdownimage-20200528210744870.png" alt="image-20200528210744870" style="zoom:50%;" />

即使缓存存在也会因为客户端的需求等原因向源服务器确认资源有效性

## 客户端的缓存

客户端缓存和缓存服务器一样，要是缓存失效了就会向源服务器确认资源有效性，失效的话就会请求新的资源

